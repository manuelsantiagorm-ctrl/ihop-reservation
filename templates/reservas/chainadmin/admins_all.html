{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Sucursales por pa√≠s" %}{% endblock %}

{% block content %}
<div class="container py-4" style="max-width:1100px;">

  <!-- Encabezado -->
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h1 class="h4 mb-0">
      <i class="bi bi-shop me-1"></i> {% trans "Sucursales por pa√≠s" %}
    </h1>
    <div class="d-flex gap-2">
      <a href="{% url 'reservas:chainadmin_admins_all' %}" class="btn btn-outline-secondary">
        {% trans "Ver todos los administradores" %}
      </a>
      <a href="{% url 'reservas:chainadmin_sucursal_nueva' %}" class="btn btn-primary">
        {% trans "Nueva sucursal" %}
      </a>
    </div>
  </div>

  <!-- üîπ Pesta√±as: Sucursales | Admins sucursal | Referentes -->
  <ul class="nav nav-pills mb-3">
    <li class="nav-item">
      <a class="nav-link active" aria-current="page" href="{% url 'reservas:chainadmin_sucursales' %}">
        {% trans "Sucursales" %}
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="{% url 'reservas:chainadmin_admins' %}">
        {% trans "Admins sucursal" %}
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="{% url 'reservas:chainadmin_country_admins_all' %}">
        {% trans "Referentes (por pa√≠s)" %}
      </a>

    </li>
  </ul>

  {% if grouped %}
    <!-- Tabs por pa√≠s -->
    <ul class="nav nav-tabs mb-3" role="tablist">
      {% for pais, sucursales in grouped.items %}
        <li class="nav-item" role="presentation">
          <button class="nav-link {% if forloop.first %}active{% endif %}"
                  data-bs-toggle="tab" data-bs-target="#tab-{{ forloop.counter }}"
                  type="button" role="tab">
            {{ pais }} <span class="badge bg-secondary">{{ sucursales|length }}</span>
          </button>
        </li>
      {% endfor %}
    </ul>

    <div class="tab-content">
      {% for pais, sucursales in grouped.items %}
        <div class="tab-pane fade {% if forloop.first %}show active{% endif %}"
             id="tab-{{ forloop.counter }}" role="tabpanel">

          <div class="card shadow-sm border-0 mb-4">
            <div class="card-body p-0">
              <div class="table-responsive">
                <table class="table align-middle mb-0">
                  <thead class="table-light">
                    <tr>
                      <th>{% trans "Nombre" %}</th>
                      <th>{% trans "Slug" %}</th>
                      <th>{% trans "Activo" %}</th>
                      <th class="text-end">{% trans "Acciones" %}</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for s in sucursales %}
                      <tr>
                        <td>{{ s.nombre }}</td>
                        <td>{{ s.slug }}</td>
                        <td>
                          {% if s.activo %}
                            <span class="badge bg-success">{% trans "Activo" %}</span>
                          {% else %}
                            <span class="badge bg-secondary">{% trans "Inactivo" %}</span>
                          {% endif %}
                        </td>
                        <td class="text-end">
                          <a class="btn btn-sm btn-outline-primary"
                             href="{% url 'reservas:chainadmin_sucursal_editar' s.pk %}">
                            {% trans "Editar" %}
                          </a>
                          <a class="btn btn-sm btn-outline-danger"
                             href="{% url 'reservas:chainadmin_sucursal_eliminar' s.pk %}">
                            {% trans "Eliminar" %}
                          </a>
                        </td>
                      </tr>
                    {% empty %}
                      <tr>
                        <td colspan="4" class="text-center text-muted py-4">
                          {% trans "No hay sucursales en este pa√≠s." %}
                        </td>
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
            </div>
          </div>

        </div>
      {% endfor %}
    </div>

  {% else %}
    <div class="alert alert-info d-flex align-items-center" role="alert">
      <i class="bi bi-info-circle me-2"></i>
      <div>{% trans "No hay pa√≠ses ni sucursales para mostrar con tu alcance actual." %}</div>
    </div>
  {% endif %}
</div>
{% endblock %}
