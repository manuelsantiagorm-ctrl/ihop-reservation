{% extends "base.html" %}
{% load i18n static %}

{% block title %}{% trans "Reserva confirmada" %} | IHOP{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'reservas/css/reservar.css' %}">
{% endblock %}

{% block content %}
<div class="container py-4 reservar">

  <!-- Breadcrumb -->
  <nav class="breadcrumb-lite mb-3">
    <a href="{% url 'reservas:home' %}">{% trans "Inicio" %}</a> /
    <a href="{% url 'reservas:seleccionar_sucursal' %}">{% trans "Sucursales" %}</a> /
    {% if request.user.is_staff %}
      <a href="{% url 'reservas:admin_mesas_disponibles' reserva.mesa.sucursal.id %}">{{ reserva.mesa.sucursal.nombre }}</a> /
    {% else %}
      <a href="{% url 'reservas:sucursal_detalle' reserva.mesa.sucursal.slug %}">{{ reserva.mesa.sucursal.nombre }}</a> /
    {% endif %}
    <span>{% trans "Reserva confirmada" %}</span>
  </nav>

  <header class="page-head d-flex justify-content-between align-items-start gap-3 mb-3">
    <div>
      <h1 class="mb-1">{% trans "¡Tu reservación está confirmada!" %}</h1>
      <p class="lead text-muted mb-0">
        {% blocktrans with n=reserva.mesa.numero|default:reserva.mesa.id c=reserva.mesa.capacidad %}
          Mesa {{ n }} • {{ c }} pax
        {% endblocktrans %}
      </p>
    </div>
    <span class="pill meta">
      {% trans "Folio" %}: <strong>{{ reserva.folio }}</strong>
    </span>
  </header>

  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <div class="row g-3">
        <!-- Columna izquierda -->
        <div class="col-md-6">
          <div class="border rounded p-3 h-100">
            <h6 class="text-muted mb-2">{% trans "Detalles de la reserva" %}</h6>
            <ul class="list-unstyled mb-0">
              <li><strong>{% trans "Sucursal" %}:</strong> {{ reserva.mesa.sucursal.nombre }}</li>
              <li><strong>{% trans "Fecha" %}:</strong> {{ fecha_txt }}</li>
              <li><strong>{% trans "Hora" %}:</strong> {{ hora_txt }}</li>
              <li><strong>{% trans "Duración" %}:</strong> {{ duracion_min }} {% trans "min" %}</li>
              <li><strong>{% trans "Personas" %}:</strong> {{ personas }}</li>
              <li><strong>{% trans "Estado" %}:</strong> {{ reserva.get_estado_display|default:_("Confirmada") }}</li>
            </ul>
          </div>
        </div>

        <!-- Columna derecha -->
        <div class="col-md-6">
          <div class="border rounded p-3 h-100">
            <h6 class="text-muted mb-2">{% trans "Contacto" %}</h6>
            <ul class="list-unstyled mb-0">
              <li><strong>{% trans "Nombre" %}:</strong> {{ contacto_nombre }}</li>
              <li><strong>{% trans "Correo electrónico" %}:</strong> {{ contacto_email }}</li>
              {% if contacto_tel %}
                <li><strong>{% trans "Teléfono" %}:</strong> {{ contacto_tel }}</li>
              {% endif %}
              {% if notas %}
                <li class="mt-2"><strong>{% trans "Notas" %}:</strong><br>{{ notas|linebreaksbr }}</li>
              {% endif %}
            </ul>
          </div>
        </div>
      </div>

      <!-- CTA -->
      <div class="d-flex flex-wrap gap-2 mt-4">
        <a class="btn btn-primary" href="{% url 'reservas:mis_reservas' %}">
          <i class="bi bi-journal-text me-1"></i> {% trans "Ver mis reservaciones" %}
        </a>
        <a class="btn btn-outline-secondary" href="{% url 'reservas:home' %}">
          <i class="bi bi-house-door me-1"></i> {% trans "Ir al inicio" %}
        </a>

        {% if request.user.is_staff %}
          <a class="btn btn-outline-dark" href="{% url 'reservas:admin_mesas_disponibles' reserva.mesa.sucursal.id %}">
            <i class="bi bi-list-ul me-1"></i> {% trans "Ver mesas (staff)" %}
          </a>
        {% else %}
          <a class="btn btn-outline-dark" href="{% url 'reservas:sucursal_detalle' reserva.mesa.sucursal.slug %}">
            <i class="bi bi-geo-alt me-1"></i> {% trans "Ver sucursal" %}
          </a>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Info -->
  <div class="alert alert-success border-0 shadow-soft">
    <div class="d-flex gap-2 align-items-start">
      <i class="bi bi-check-circle-fill fs-4"></i>
      <div>
        <strong>{% trans "¡Listo!" %}</strong>
        <div class="small mb-0">
          {% trans "Te enviamos un correo con los detalles. Por favor llega a tiempo; la mesa se conserva unos minutos después de tu hora." %}
        </div>
      </div>
    </div>
  </div>

</div>
{% endblock %}
